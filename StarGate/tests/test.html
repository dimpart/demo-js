<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>StarGate Test Cases</title>
    <link href="../../Crypto/tests/test.css" type="text/css" rel="stylesheet" />
    <script src="../../Crypto/libs/loader.js"></script>
    <script src="../../Crypto/libs/runner.js"></script>
    <script src="../../Crypto/libs/utils.js"></script>

    <script src="../../DIMP/dist/dimp.js"></script>
    <script src="../../Plugins/dist/plugins.js"></script>
    <script>
        if (typeof MONKEY !== 'object') {
            var MONKEY = DIMP;
        }
    </script>
    <script src="../../FSM/dist/fsm.js"></script>
    <script src="../../StarTrek/dist/startrek.js"></script>

    <script src="../src/sources.js"></script>
    <script>
        var TestRunner = Runner;

        !function (ns) {
            var sources = [
                'src/requires.js'
            ].concat(sg_sources);
            var dist = 'dist/stargate.js';

            var tests = [
                '../../Crypto/tests/format/utf8.js',
                '../../Crypto/tests/format/json.js',
                '../../Crypto/tests/format/hex.js',
                '../../Crypto/tests/format/base58.js',
                '../../Crypto/tests/format/base64.js',
                '../../Crypto/tests/crypto_tests.js',

                '../../FSM/tests/fsm_tests.js',

                '../../StarTrek/tests/startrek_tests.js',

                'tests/sg_tests.js',
                null
            ];

            var base = window.location.href;
            base = base.substring(0, base.indexOf('tests/test.html'));
            var loader = new Loader(base);
            loader.importJS('src/namespace.js');

            for (var i = 0; i < sources.length; ++i) {
                loader.importJS(sources[i]);
            }
            for (var j = 0; j < tests.length; ++j) {
                loader.importJS(tests[j]);
            }

            ns.sources = sources;
            ns.dist = dist;
        }(window);

        $(function () {
            var runner = new TestRunner('crypto_tests');
            runner.run(crypto_tests);
        });

        $(function () {
            var runner = new TestRunner('fsm_tests');
            runner.run(fsm_tests);
        });

        $(function () {
            var runner = new TestRunner('startrek_tests');
            runner.run(startrek_tests);
        });

        $(function () {
            var runner = new TestRunner('sg_tests');
            runner.run(sg_tests);
        });
    </script>
</head>
<body>

<h2>Crypto Tests</h2>
<div id="crypto_tests">Testing ...</div>
<div>&nbsp;</div>

<h2>FiniteStateMachine Tests</h2>
<div id="fsm_tests">Testing ...</div>
<div>&nbsp;</div>

<h2>StarTrek Tests</h2>
<div id="startrek_tests">Testing ...</div>
<div>&nbsp;</div>

<h2>StarGate Tests</h2>
<div id="sg_tests">Testing ...</div>
<div>&nbsp;</div>

<h2>Makefile</h2>
<p class="console">
    <script>
        !(function () {
            var targets = [
                'src/ns_begin.closure'
            ];
            for (var i = 0; i < sources.length; ++i) {
                var file = sources[i];
                if (file) {
                    targets.push(file);
                }
            }
            targets.push('src/ns_end.closure');

            var text = targets.join(' ');
            text = 'cat ' + text + ' > ' + dist;
            document.writeln(text);
        }());
    </script>
</p>
<p class="console">
    <script>
        !(function () {
            var targets = [
                'src/net_begin.closure',

                '../../../moky/FiniteStateMachine/fsm-js/FSM/dist/fsm.js',
                '../../../moky/wormhole/startrek-js/StarTrek/dist/startrek.js',
                dist,

                'src/net_end.closure'
            ];

            var text = targets.join(' ');
            text = 'cat ' + text + ' > dist/network.js';
            document.writeln(text);
        }());
    </script>
</p>
</body>
</html>
